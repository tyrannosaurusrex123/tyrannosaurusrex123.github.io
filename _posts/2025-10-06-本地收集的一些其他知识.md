---
title: "本地收集的一些其他知识"
date: 2025-10-06
categories: [Windows常用知识]






---



## 本地收集一些其他命令

#### 1.`systeminfo`要关注啥？

- 操作系统的版本

- 修补程序（看是否还有未安装的补丁）
  ``````
  修补程序:           安装了 3 个修补程序。
                      [01]: KB5064401
                      [02]: KB5065426
                      [03]: KB5064531
  ``````

- 看BIOS版本

- 看当前主机是在工作组还是域下（目前Windows只区分了这两种）

- 看系统类型是工作站还是服务器

- 看系统启动时间（这个也跟补丁有关）
  系统启动时间：并不是你电脑开机的时间，而是操作系统内核加载并准备好接收用户登录的准确时间点，可以简要理解为主机最近一次重启的时间->因为只有重启才会完全重新加载内核（具体可以了解`Hiberfil.sys`文件）

#### 2.`netstat`能提供啥？

- 本地地址和外部地址的对应：本地是主机绑定的，外部是与我们建立连接的另一个主机
- 状态：
  状态有很多，需要关注的就是`LISTENING,ESTABLISHED,TIME_WAIT,CLOSE_WAIT`
  `LISTENING`是监听还未建立连接的意思，所以如果你不使用-a参数是看不到它的
- PID：可以结合`tasklist | findstr <PID>`来找到特定的程序

#### 3.`net`系命令

- 有`net session`，`net use`，`net share`，`net user`等，它们围绕的协议是SMB协议，主要关注和管理Windows文件和打印机共享服务
- 涵盖的内容：
  - 本地所有的组
  - 开放的共享

#### 4.tasklist系命令

- `tasklist`查看所有进程
- `tasklist /svc`命令能够额外提供服务名
- 一个可执行文件可以开多个独立的进程，一个进程可以对应多个服务

#### 5.wmic命令

- 信息从哪来？
  Windows底层有一个WMI服务，信息是通过WMI服务从WMI类中读取的
  可以将WMI当作一个大型的数据库，`wmic`命令是访问该数据库的钥匙之一

- 能拿到的信息？
  所有与管理相关的信息

- 一些<u>核心信息</u>类别：

  - **硬件和系统基础信息**

  | 别名 (Alias)       | 描述 (可查询的信息) | 常用示例                                    |
  | ------------------ | ------------------- | ------------------------------------------- |
  | **COMPUTERSYSTEM** | 电脑的整体信息      | 制造商、型号、域名、总物理内存、机器名称    |
  | **OS**             | 操作系统信息        | 版本号、架构（32/64位）、系统目录、安装日期 |
  | **BIOS**           | BIOS 固件信息       | 版本、制造商、序列号                        |
  | **CPU**            | 中央处理器信息      | 核心数、线程数、时钟速度、制造商、状态      |
  | **MEMORYCHIP**     | 物理内存条信息      | 容量、速度、位置                            |
  | **DISKDRIVE**      | 物理磁盘驱动器信息  | 制造商、型号、序列号、接口类型、容量        |
  | **LOGICALDISK**    | 逻辑分区信息        | 盘符（C:, D: 等）、文件系统、容量、剩余空间 |

  

  - **软件和应用信息**

  | 别名 (Alias) | 描述 (可查询的信息)                               | 常用示例                                          |
  | :----------- | ------------------------------------------------- | ------------------------------------------------- |
  | **PRODUCT**  | **已安装的软件信息**                              | 软件名称、版本、供应商、安装路径                  |
  | **QFE**      | **已安装的补丁/更新信息** (Quick Fix Engineering) | 补丁 ID、安装日期、描述                           |
  | **PROCESS**  | **当前运行的进程**                                | 进程名称、PID、可执行文件路径、命令行参数         |
  | **SERVICE**  | **系统服务状态**                                  | 服务名称、显示名称、状态（运行中/停止）、启动模式 |

  

  - **网络和安全信息**

  | 别名 (Alias)    | 描述 (可查询的信息) | 常用示例                                          |
  | --------------- | ------------------- | ------------------------------------------------- |
  | **NICCONFIG**   | 网卡配置信息        | IP 地址、MAC 地址、子网掩码、默认网关、DNS 服务器 |
  | **NETCLIENT**   | 网络客户端信息      | 协议绑定、连接信息                                |
  | **USERACCOUNT** | **本地用户账户**    | 用户名、SID、状态、密码是否可更改                 |
  | **GROUP**       | **本地用户组**      | 组名称、组成员信息                                |
  | **STARTUP**     | **系统启动项**      | 程序名称、命令、位置（注册表或启动文件夹）        |
  | **SHARE**       | **共享文件夹**      | 共享名称、本地路径                                |

- 两个常用的动词（GET，LIST）：

  - GET用于精确查询，在后面加上你需要知道的属性名词（以逗号隔开）
  - LIST用于概览，在后面加上副词显示一个预设好的属性集（而非自己挨个选择）（例如BRIEF,FULL）

- 使用`/format:list`时遇到`此级别的开关异常`：

  - `/format:list`是一个用于改善排版的全局开关
  - 该报错是因为语法要求全局开关必须放在动词和其参数的后面
    而当你只使用别名的时候会默认在最后加上`list brief`，这样如果你的命令是`wmic GROUP /format:list`就会有这个报错

- 也可像SQL语句用`where`进行过滤

#### 6.schtasks命令

- 作用？
  管理计划任务的

- 使用的结构：
  `schtasks /<操作> [任务名称] [任务细节参数]`
  一些操作参数

  | 参数 (操作) | 描述                                               | 常用场景示例                                                 |
  | ----------- | -------------------------------------------------- | ------------------------------------------------------------ |
  | /create     | 创建一个新的计划任务。                             | schtasks /create /tn "BackupScript" /tr "C:\backup.bat" /sc daily /st 02:00 (每天凌晨 2 点运行备份脚本) |
  | /change     | 修改现有计划任务的属性。                           | schtasks /change /tn "MyTask" /st 10:00 (将任务的启动时间改为 10:00) |
  | /run        | 立即运行一个计划任务，而无需等待其预定的触发时间。 | schtasks /run /tn "WindowsUpdate" (手动立即启动 Windows 更新任务) |
  | /end        | 停止/终止一个当前正在运行的计划任务实例。          | schtasks /end /tn "LongRunningReport" (停止一个正在运行中的报告生成任务) |
  | /delete     | 删除一个计划任务。                                 | schtasks /delete /tn "OldTask" /f (删除名为 "OldTask" 的任务，/f 强制执行) |
  | /?          | 显示帮助信息。                                     | schtasks /create /? (显示 /create 操作的所有详细选项和示例)  |
  | /query      | 展示计划任务。                                     | schtasks /query /v /fo list 以表格样式详细展示计划任务       |

